<!DOCTYPE html><html>
<head><meta http-equiv="content-type" content="text/html;charset=utf-8">
<title></title>
</head>
<script language="javascript">
var isOpen=false;
var fileName = window.location.href.split('?file=')[1];
var check = fileName;
function OpenDoc()
{
	if(fileName != check){
		alert('地址栏参数不允许修改！');
		return;
	}
	//取得WebOffice对象
	var WebOffice=document.getElementById("WebOffice");
	//通过对象WebOffice的Open方法打开个一个服务器文档
	//此处服务器文档地址为：http://localhost/weboffice/20161108144356.doc
	var nowFileName = '';
	if(fileName.indexOf('new') != -1){
		nowFileName = "/upload/mediateModel/1.docx";
	}else{
		nowFileName = fileName;
	}
	WebOffice.Open("http://mediate.ptnetwork001.com"+nowFileName,false,"Word.Document");
	isOpen=true;
}

function OpenSave()
{
	if(fileName != check){
		alert('地址栏参数不允许修改！');
		return;
	}
	if(isOpen)
	{
		var nowFileName = '';
		if(fileName.indexOf('new') != -1){
			nowFileName = fileName.split('new')[0];
		}else{
			nowFileName = fileName;
		}
		var msg = WebOffice.Save('http://mediate.ptnetwork001.com:7878/saveDoc.jsp?file='+nowFileName);
		alert('文件上传成功！');
	}
}
</script>
<body>
	<div>
		<input type=button onclick="OpenDoc();" value="打开">
		<input type=button onclick="OpenSave();" value="保存">
	</div>
<script language="javascript">
if (!!window.ActiveXObject || "ActiveXObject" in window){
document.write('<object classid="clsid:FF09E4FA-BFAA-486E-ACB4-86EB0AE875D5" codebase="WebOffice.ocx#Version=2019,1,7,3" id="WebOffice" width="900" height="500" >');
document.write('</object>');
}
else
{
document.write('<object id="WebOffice" CLSID="{FF09E4FA-BFAA-486E-ACB4-86EB0AE875D5}" TYPE="application/x-itst-activex"  width=100% height=900></object>');
}
setTimeout(function(){
OpenDoc();
},1000)//延迟一秒打开文件
</script>
</body>
</html>